@model X.PagedList.IPagedList<DPLK.Models.AuditTrail>
@using X.PagedList.Mvc.Core
<link href="~/css/PagedList.css" rel="stylesheet" type="text/css" />
@{
    ViewData["Title"] = "Audit Trail List";
    Layout = "~/Views/Shared/DPLK_Layout.cshtml";
}

<div class="container-xxl flex-grow-1 container-p-y">
    <div class="table-responsive text-nowrap">
      
            <div class="card-header">
                <h2 class="text-center mb-3 text-danger">Audit Trail</h2>
                <!-- Other header content -->
                <div class="row">
                    <div class="col-sm-10">
                        <br />
                        <div class="row">
                            @using (Html.BeginForm("Index", "AuditTrail", FormMethod.Get))
                            {
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="row">
                                            <div class="col-lg-6 col-md-6 col-sm-12">
                                                @Html.TextBox("SearchString", ViewBag.currentFilter as string, new {@class = "form-control search-slt", @placeholder = "Search By Field Name, User ID, etc."})
                                            </div>
                                            <div class="col-lg-3 col-md-3 col-sm-12">
                                                <button type="submit" class="btn btn-primary">Search</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                   
              @*      <div>
                        Page Size : @Html.DropDownList("PageSize",
                        ViewBag.PageSize as SelectList,
                        new{
                        @class = "form-control search-slt",
                        @onchange="getPagedSize(this.value)"
                        }
                        )
                    </div>*@
               
                </div>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive text-nowrap">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>
                                    Table Name
                                </th>
                                <th>
                                    Field Name
                                </th>
                                <th>
                                    User ID
                                </th>
                                <th>
                                    Host Name
                                </th>
                                <th>
                                    AppNm
                                </th>
                                <th>
                                    Old Data
                                </th>
                                <th>
                                    CycleDt
                                </th>
                                <th>
                                    GroupNmbr
                                </th>
                                <th>
                                    Certificate Number
                                </th>
                                <th>
                                    Info1
                                </th>
                                <th>
                                    Info 2
                                </th>
                                <th>
                                    Info 3
                                </th>
                                <th>
                                    Info 4
                                </th>
                                <th>
                                    Info 5
                                </th>
                                <th>
                                    Last Change Date
                                </th>
                                <th>
                                    CodeType
                                </th>
                
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model)
                            {
                                <tr>
                                    <td>@item.TableNm</td>
                                    <td>@item.FieldNm</td>
                                    <td>@item.UsrId</td>
                                    <td>@item.HostNm</td>
                                    <td>@item.AppNm</td>
                                    <td>@item.OldData</td>
                                    <td>@item.NewData</td>
                                    <td>@item.CycleDt</td>
                                    <td>@item.GroupNmbr</td>
                                    <td>@item.CerNmbr</td>
                                    <td>@item.Info1</td>
                                    <td>@item.Info2</td>
                                    <td>@item.Info3</td>
                                    <td>@item.Info4</td>
                                    <td>@item.Info5</td>
                                    <td>@item.LastChangeDt</td>
                                    <td>@item.CodeType</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="text-center mt-4">
                @Html.PagedListPager(Model,
                page => Url.Action("AuditTrail", new {page, CurrentFilter = ViewBag.currentFilter, FetchSize = ViewBag.pageSize})
                )
            </div>
        </div>
    </div>
</div>

<script>
    function getPagedSize(value) {
        document.location.href = "/AuditTrail?&pageSize=" + value + "&currentFilter=@ViewBag.CurrentFilter&sortOrder=@ViewBag.CurrentSort";
    }
</script>

